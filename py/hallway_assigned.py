import numpy as np
import open3d as o3d

# Your raw data (converted to Python lists)
data_pt1 = """
# Set 0
0 2637.0 0.0
0 2581.4268580213025 513.4777275464495
0 2484.31206292285 1029.0357496297265
0 3008.2570573106086 2010.0531030649206
0 2551.9483733022503 2551.9483733022503
0 1974.4966081516666 2955.043002123246
0 1500.1190548711522 3621.607767444244
0 503.3330308016111 2530.4260234403346
0 1.454268073987482e-13 2375.0
0 -548.2038048653202 2756.0066379330774
0 -946.758811671232 2285.677963432923
0 -626.6832228461113 937.8977226772708
0 -533.8656197958434 533.8656197958434
0 -476.4320878493585 318.34174352023206
0 -327.0533545089955 135.46993505724183
0 -309.92814860742084 61.6485417570965
0 -319.0 3.906623289280057e-14
0 -391.33332688088893 -77.84103848443522
0 -377.8667287971163 -156.51752383732168
0 -345.8913587178588 -231.11721693615456
0 -364.1599923110721 -364.15999231107196
0 -334.4532802778005 -500.54470660613225
0 -311.50431394518284 -752.0379394641875
0 -236.44947028354795 -1188.7117598487152
0 -4.259933890834068e-13 -2319.0
0 450.6586438572564 -2265.6139977314624
0 888.973613384104 -2146.172154023719
0 1372.2584755584166 -2053.7299423872873
0 1902.1172413918123 -1902.1172413918132
0 2782.0973227643162 -1858.937999683589
0 2871.4175870450795 -1189.3801077906983
0 2828.584748682916 -562.6404886945153
# Set 1
500 2574.0 0.0
500 2501.0024650282376 497.48032114112704
500 2380.837555281586 986.1752052048364
500 3007.425587698306 2009.497532831901
500 2443.0539289995218 2443.0539289995218
500 1952.2737988308825 2921.7842176311437
500 1514.6610253010256 3656.715189679673
500 448.90283095911127 2256.7869302078334
500 1.3440498620642201e-13 2195.0
500 -510.7464630382236 2567.6958640956573
500 -737.813657599893 1781.2397386817609
500 -755.5755169066591 1130.7986727314615
500 -572.7564927611035 572.7564927611036
500 -534.6349607105367 357.2316598316042
500 -468.4069229832224 194.0205002091006
500 -462.93065235032475 92.08263199161249
500 -445.0 5.4496782562057217e-14
500 -441.3533761814537 -87.79064490725776
500 -424.06070542268066 -175.65169545557615
500 -399.1054139052217 -266.6737118494091
500 -366.98841943581823 -366.9884194358181
500 -357.7872300646238 -535.4664303228392
500 -321.4540831866752 -776.0588073094809
500 -246.00889606233824 -1236.7702385884734
500 -4.2378902484494155e-13 -2307.0
500 453.19481804346606 -2278.3642063767043
500 908.8731518670887 -2194.213889714306
500 1403.9259788405338 -2101.1237102885325
500 1999.697977195556 -1999.6979771955569
500 2734.703554863071 -1827.2704964014715
500 2934.2413952558472 -1215.4025811915244
500 2729.52543536219 -542.9363661708862
# Set 2
1000 2576.0 0.0
1000 2508.8487472714633 499.04104371725606
1000 2387.304712009165 988.853989231392
1000 2948.3912452248255 1970.0520462875093
1000 2408.405696721381 2408.405696721381
1000 1969.4964760544901 2947.559775612523
1000 1495.9095371151361 3611.44509258662
1000 507.2348372419337 2550.0417290483992
1000 1.3587456236539884e-13 2219.0
1000 -470.5578567029012 2365.654096332592
1000 -696.4838469044633 1681.460749170542
1000 -749.4642443434435 1121.6525069961333
1000 -569.2209588551707 569.2209588551708
1000 -533.8034910982341 356.6760895985846
1000 -472.1024411132675 195.55123393856093
1000 -474.7000757151635 94.42371585580604
1000 -458.0 5.608882340094878e-14
1000 -453.12279954629247 -90.13172877145131
1000 -436.9950188778387 -181.0092635086874
1000 -415.7348061512726 -277.7851165098011
1000 -378.302127934803 -378.3021279348029
1000 -358.898370530663 -537.1293695474442
1000 -319.15798259248464 -770.5155301144132
1000 -240.1561864018544 -1207.3466801763766
1000 -4.2305423676545314e-13 -2303.0
1000 458.8524373819338 -2306.806979508398
1000 938.3397761592007 -2265.352613717675
1000 1445.0381760839844 -2162.6524615989206
1000 2006.0619382262348 -2006.0619382262357
1000 2686.478317349524 -1795.0474228863347
1000 2939.784672450915 -1217.698681785715
1000 2747.179570409448 -546.4479919671766
# Set 3
1500 2543.0 0.0
1500 2481.386759420173 493.5785147008045
1500 2359.5883260338264 977.3734862604393
1500 2938.413609877195 1963.385203491274
1500 2400.627522128329 2400.627522128329
1500 1846.715454557158 2763.8049912936604
1500 1387.6101257558157 3349.9871848859257
1500 506.25938563185304 2545.137802646383
1500 1.846155049714635e-13 3015.0
1500 -650.6262239237875 3270.9189101447737
1500 -779.5261517276878 1881.9426077254911
1500 -718.9078815273654 1075.9216783194934
1500 -599.6265504461923 599.6265504461924
1500 -587.0175462855971 392.23258451183915
1500 -533.0784902590125 220.80834047465686
1500 -524.7201250157283 104.37332227862856
1500 -488.0 5.976276379839084e-14
1500 -467.8345787523409 -93.05808360169323
1500 -443.4621756054177 -183.68804753524304
1500 -420.7236238250879 -281.1185379079188
1500 -383.25187540310884 -383.2518754031087
1500 -362.7873621618002 -542.949656833562
1500 -223.1044410688472 -538.6217674540802
1500 -244.2530831641931 -1227.9431710648444
1500 -4.2397272186481364e-13 -2308.0
1500 456.3162631957241 -2294.056770863156
1500 920.3536548380415 -2221.9302756896445
1500 1393.3701444131614 -2085.325787654784
1500 1860.397941301806 -1860.397941301807
1500 2365.531047000741 -1580.5973129407682
1500 2620.1223542020093 -1085.290214187394
1500 2585.3499991429153 -514.2580888345153
# Set 4
2000 2442.0 0.0
2000 2389.1929430622695 475.2400244312884
2000 2269.04813184772 939.8705098886605
2000 2945.8968363879176 1968.3853355884505
2000 2428.9117933757907 2428.9117933757907
2000 1741.1571102834337 2605.825764956177
2000 929.5380572148032 2244.1033844699155
2000 436.4170503500791 2194.0166722620265
2000 1.251589028728595e-13 2044.0
2000 -387.4493795240306 1947.8395668808157
2000 -763.8361310007191 1844.0635468925284
2000 -858.3560100152855 1284.6205510074321
2000 -692.9646455628165 692.9646455628166
2000 -572.8825628764538 382.7878905505059
2000 -512.7531405437642 212.3893049626249
2000 -502.162063566454 99.88624487225762
2000 -473.0 5.79257935996698e-14
2000 -459.98829650911506 -91.4973610255642
2000 -433.29950074779356 -179.47852977922705
2000 -404.92570119133956 -270.5627034805463
2000 -368.40263299819134 -368.4026329981912
2000 -351.67595750140816 -526.3202645875111
2000 -237.2637280663555 -572.8053101569978
2000 -104.76350292266109 -526.6816955765347
2000 -9.093002483669097e-14 -495.0
2000 94.61880617782222 -475.6808609955668
2000 186.36683156179882 -449.9293323329966
2000 278.34068674282054 -416.5662757635753
2000 389.6158364337876 -389.61583643378776
2000 546.2755352827722 -365.00964309387865
2000 694.7574084484877 -287.77794113854736
2000 1074.9406673219405 -213.81899292967708
# Set 5
2500 2424.0 0.0
2500 2358.788599369769 469.1922244487884
2500 2246.8750230674495 930.6861075118984
2500 2900.166007711278 1937.8289727723725
2500 2271.226981171191 2271.226981171191
2500 1524.4847194057886 2281.5526161581843
2500 962.0661489658359 2322.633144733375
2500 414.5669342842727 2084.1687208568646
2500 9.05013984569894e-14 1478.0
2500 -284.8318701435472 1431.9465093887163
2500 -736.2829238704327 1777.5442205517156
2500 -1056.6945832032836 1581.4552025994408
2500 -632.1534623807735 632.1534623807735
2500 -552.0958225688901 368.8986347250158
2500 -546.0128037141704 226.16590852776812
2500 -501.18127828605077 99.69115455024149
2500 -487.0 5.96402991184761e-14
2500 -457.04594066790537 -90.91209005951582
2500 -436.9950188778387 -181.0092635086874
2500 -401.59982274212933 -268.3404225484679
2500 -383.25187540310884 -383.2518754031087
2500 -336.67556120987894 -503.8705850553424
2500 -280.1242724912455 -676.279817798262
2500 -135.5877738012094 -681.6457698802451
2500 -1.2289330629443689e-13 -669.0
2500 128.1743415645963 -644.3759292249224
2500 252.5710653609594 -609.7604914574491
2500 391.1214440457997 -585.354607060992
2500 553.6646096690665 -553.6646096690669
2500 721.7156234786092 -482.2349622610147
2500 1031.049558282596 -427.07471051944
2500 1308.3675640579092 -260.2504895695157
# Set 6
3000 2454.0 0.0
3000 2365.654096332592 470.55785670290135
3000 2256.1138183925623 934.5129418355492
3000 2812.8616984195105 1879.494098305314
3000 2371.6361440996807 2371.6361440996807
3000 1612.2648162228859 2412.9248149019863
3000 926.4765897558825 2236.712348209825
3000 441.6844890445145 2220.4978748329136
3000 1.0525839238671501e-13 1719.0
3000 -304.34090234516 1530.0250374290395
3000 -568.6675804945233 1372.8849853117722
3000 -769.4647727321492 1151.585413039025
3000 -702.1570337182417 702.1570337182418
3000 -588.6804855102021 393.34372497787837
3000 -535.8501288565463 221.95639077175213
3000 -527.6624808569379 104.95859324467695
3000 -494.0 6.049755187787925e-14
3000 -471.7577198739538 -93.83844488975774
3000 -447.15769373546283 -185.2187812647034
3000 -423.21803266199555 -282.7852486069776
3000 -383.25187540310884 -383.2518754031087
3000 -362.7873621618002 -542.949656833562
3000 -282.42037308543604 -681.8230949933297
3000 -137.92885766540297 -693.4151932450839
3000 -1.2105633609571586e-13 -659.0
3000 126.41852866645114 -635.5488617012933
3000 250.65764819913394 -605.1410937948928
3000 373.89876682219204 -559.5790490796131
3000 530.3300858899105 -530.3300858899107
3000 743.3338333984755 -496.67978831952433
3000 951.5959184866255 -394.16393533604224
3000 1451.5622149967808 -288.73367658387053
# Set 7
3500 2439.0 0.0
3500 2347.9999612853335 467.046230906611
3500 2237.6362277423364 926.8592731882475
3500 2186.765080355694 1461.1497128415538
3500 2419.719405220366 2419.719405220366
3500 1646.1546004370816 2463.6444612524415
3500 944.4627110770417 2280.1346862378555
3500 451.82918578935323 2271.498709413882
3500 1.270571054115379e-13 2075.0
3500 -365.98944410225647 1839.9531860364602
3500 -709.1124001725112 1711.9487737434142
3500 -836.6887709275211 1252.1932361276329
3500 -659.0235200658623 659.0235200658624
3500 -441.5103641326516 295.00779373340873
3500 -343.6831860941987 142.35823683981343
3500 -309.92814860742084 61.6485417570965
3500 -320.0 3.9188697572715304e-14
3500 -373.6791918336308 -74.3294126881449
3500 -359.38913814689056 -148.86385519001988
3500 -308.4752261642443 -206.11655645027244
3500 -297.6919548795366 -297.69195487953647
3500 -333.3421398117613 -498.88176738152714
3500 -269.0264529526579 -649.4873113554346
3500 -128.75961253064492 -647.318285066132
3500 -1.1370845530083175e-13 -619.0
3500 117.44437385370924 -590.4327388027447
3500 233.81957717506998 -564.4903943643961
3500 350.00924680234914 -523.8258557506036
3500 495.68185361176967 -495.68185361176995
3500 698.434474334138 -466.6789957364658
3500 896.1631465359483 -371.20292939413685
3500 1348.5797605544417 -268.24919277217697
# Set 8
4000 2437.0 0.0
4000 2353.884672967753 468.2167728387078
4000 2236.712348209825 926.4765897558824
4000 2165.97834004813 1447.2604570160636
4000 2479.8234816212225 2479.8234816212225
4000 1547.8186691926119 2316.474339874891
4000 950.5856459948832 2294.9167587580364
4000 454.9506309416113 2287.1912739003333
4000 1.308535104888947e-13 2137.0
4000 -405.20259882749826 2037.0910273975096
4000 -796.3642227517518 1922.5933071559878
4000 -826.6885067331682 1237.2267831061872
4000 -688.7220048756973 688.7220048756973
4000 -546.2755352827722 365.00964309387865
4000 -481.3412364383804 199.37806826221183
4000 -476.66164627597 94.8138964998383
4000 -453.0 5.54765000013751e-14
4000 -448.2188731442763 -89.15627716137065
4000 -429.6039826177484 -177.9477960497667
4000 -406.5886404159446 -271.6738439465855
4000 -373.35238046649715 -373.35238046649704
4000 -363.3429323948198 -543.7811264458646
4000 -273.618654141039 -660.5738657455701
4000 -129.14979317467717 -649.2798556269385
4000 -1.1297366722134333e-13 -615.0
4000 117.24928353169311 -589.4519535223415
4000 233.4368937427049 -563.5665148318849
4000 349.45367656932956 -522.9943861383011
4000 494.9747468305832 -494.9747468305834
4000 695.9400654972303 -465.012285037407
4000 880.4571944832563 -364.69731104393037
4000 1235.7894533080703 -245.81380574032218
# Set 9
4500 2441.0 0.0
4500 2347.9999612853335 467.046230906611
4500 2241.331745872382 928.3900069177079
4500 2527.6676213997375 1688.9335083795906
4500 2434.568647625283 2434.568647625283
4500 1651.7103027672777 2471.959157375467
4500 945.2280779417719 2281.982445302878
4500 451.82918578935323 2271.498709413882
4500 1.2999625772949155e-13 2123.0
4500 -403.05660528532087 2026.3023893130742
4500 -792.5373884281008 1913.3545118308748
4500 -933.3579914729319 1396.8689486682758
4500 -688.0148980945107 688.0148980945108
4500 -555.4217010181003 371.12091565709426
4500 -497.0471884910723 205.88368661241836
4500 -483.5271432387926 96.17952875395119
4500 -458.0 5.608882340094878e-14
4500 -450.1804437050828 -89.54645780540292
4500 -430.5278621502597 -178.33047948213178
4500 -405.75717080364205 -271.11827371356594
4500 -368.40263299819134 -368.4026329981912
4500 -360.56508122972184 -539.6237783843519
4500 -275.53207130286444 -665.1932634081265
4500 -130.7105157508062 -657.1261378701644
4500 -1.1370845530083175e-13 -619.0
4500 119.00509642983826 -598.2790210459706
4500 236.8810446339907 -571.8814306244864
4500 353.89823843348637 -529.6461430367215
4500 502.04581464244865 -502.0458146424489
4500 703.4232920079533 -470.0124171345834
4500 895.2392670034369 -370.8202459617718
4500 1271.0977234025866 -252.83705733290282
# Set 10
5000 2446.0 0.0
5000 2362.711740491382 469.972585736853
5000 2246.8750230674495 930.6861075118984
5000 2826.1652122163514 1888.3832220336278
5000 2431.740220500537 2431.740220500537
5000 1657.2660050974737 2480.2738534984924
5000 933.3648915384541 2253.342179795028
5000 445.97647612886936 2242.075151001785
5000 1.2846544923055735e-13 2098.0
5000 -399.54497948903054 2008.648254265816
5000 -784.8837197807991 1894.876921180649
5000 -888.3568025983441 1329.5199100717696
5000 -700.035713374682 700.0357133746821
5000 -585.354607060992 391.12144404579993
5000 -535.8501288565463 221.95639077175213
5000 -523.7393397353251 104.17823195661244
5000 -488.0 5.976276379839084e-14
5000 -466.8537934719377 -92.8629932796771
5000 -441.6144165403951 -182.92268067051288
5000 -418.2292149881803 -279.4518272088599
5000 -379.0092347159896 -379.00923471598946
5000 -361.1206514627414 -540.4552479966544
5000 -277.0628050323248 -668.8887815381717
5000 -132.6614189709675 -666.9339906741966
5000 -1.1628021357904119e-13 -633.0
5000 121.34618029403181 -610.0484444108093
5000 241.47324582237178 -582.9679850146218
5000 362.2317919287804 -542.1181872212596
5000 514.0666299226199 -514.0666299226202
5000 723.3785627032144 -483.3461027270539
5000 912.7929781211515 -378.0912311767085
5000 1315.2330610207318 -261.6161218236286
# Set 11
5500 2445.0 0.0
5500 2361.7309552109787 469.77749541483684
5500 2247.7989025999605 931.0687909442635
5500 2313.148461425681 1545.5963882605333
5500 2339.1092321650995 2339.1092321650995
5500 1633.9320553106504 2445.3521297817856
5500 928.390006917708 2241.331745872382
5500 435.4415987399984 2189.1127458600104
5500 1.232607003341811e-13 2013.0
5500 -396.22844401475635 1991.974904498961
5500 -782.9703026189736 1890.2575235180927
5500 -967.2477756871276 1447.588595018731
5500 -688.7220048756973 688.7220048756973
5500 -577.0399109379665 385.5657417156039
5500 -526.6113335314334 218.12955644810123
5500 -516.8738427725025 102.81259970249954
5500 -488.0 5.976276379839084e-14
5500 -466.8537934719377 -92.8629932796771
5500 -442.5382960729064 -183.30536410287795
5500 -421.55509343739044 -281.67410814093836
5500 -383.9589821842954 -383.9589821842953
5500 -367.78749425897666 -550.432883344285
5500 -282.42037308543604 -681.8230949933297
5500 -135.9779544452417 -683.6073404410515
5500 -1.1940306291686692e-13 -650.0
5500 124.46762544628986 -625.741008897261
5500 247.21349730784814 -596.8261780022912
5500 370.0097751910548 -553.7587617934953
5500 523.9661248592316 -523.9661248592319
5500 741.6708941738704 -495.5686478534851
5500 929.4228097063545 -384.9795329592801
5500 1349.560545834845 -268.4442830941931
# Set 12
6000 2468.0 0.0
6000 2378.404304977834 473.094030889111
6000 2266.2764932501864 938.7224595915652
6000 2845.2890132993098 1901.1613373930786
6000 2388.6067068481575 2388.6067068481575
6000 1640.5988981068856 2455.329765129416
6000 929.9207406471683 2245.027264002427
6000 444.2206632307242 2233.248083478156
6000 1.2215851821494847e-13 1995.0
6000 -368.52561828846615 1852.7033946817023
6000 -739.3443913293534 1784.935256811806
6000 -795.5765736840705 1190.6644848172446
6000 -687.3077913133242 687.3077913133243
6000 -588.6804855102021 393.34372497787837
6000 -536.7740083890576 222.33907420411722
6000 -528.6432661373412 105.15368356669308
6000 -493.0 6.037508719796452e-14
6000 -470.7769345935506 -93.64335456774161
6000 -445.30993467044027 -184.4534143999732
6000 -425.71244149890316 -284.4519593060364
6000 -386.7874093090416 -386.78740930904144
6000 -368.34306449199624 -551.2643529565875
6000 -281.6550062207059 -679.9753359283071
6000 -135.78286412322555 -682.6265551606483
6000 -1.1940306291686692e-13 -650.0
6000 124.0774448022576 -623.7794383364545
6000 246.83081387548305 -595.9022984697799
6000 369.45420495803523 -552.9272921811927
6000 524.6732316404182 -524.6732316404184
6000 739.1764853369627 -493.9019371544263
6000 930.3466892388659 -385.3622163916452
6000 1352.5029016760545 -269.0295540602415
# Set 13
6500 2442.0 0.0
6500 2356.827028808963 468.8020438047562
6500 2250.5705411974945 932.2168412413587
6500 2287.3729034443018 1528.3737110369257
6500 2425.3762594698583 2425.3762594698583
6500 1652.2658730002972 2472.7906269877694
6500 941.7839270504861 2273.667529510277
6500 449.0979212811274 2257.7677154882363
6500 1.2460781181324318e-13 2035.0
6500 -389.20519242217574 1956.6666344044447
6500 -784.5010363484339 1893.9530416481377
6500 -944.4693961333239 1413.4983409143267
6500 -673.8727624707798 673.8727624707799
6500 -531.3090822613265 355.0093788995258
6500 -470.25468204824494 194.78586707383076
6500 -467.8345787523409 93.05808360169314
6500 -452.0 5.535403532146036e-14
6500 -452.1420142658892 -89.93663844943518
6500 -430.5278621502597 -178.33047948213178
6500 -411.5774580897599 -275.0072653447031
6500 -377.59502115361647 -377.59502115361636
6500 -363.89850262783943 -544.6125960581671
6500 -280.8896393559757 -678.1275768632845
6500 -135.00250283516104 -678.7034140390354
6500 -1.179334867578901e-13 -642.0
6500 123.10199319217696 -618.8755119344384
6500 245.68276357838778 -593.130659872246
6500 367.2319240259568 -549.6014137319826
6500 521.844804515672 -521.8448045156722
6500 738.3450157246601 -493.34636692140674
6500 919.2601348487304 -380.7700152032641
6500 1435.8696505103292 -285.61223143161243
# Set 14
7000 2442.0 0.0
7000 2356.827028808963 468.8020438047562
7000 2243.179504937404 929.155373782438
7000 2193.4168372541144 1465.5942747057106
7000 2398.5062017847695 2398.5062017847695
7000 1656.710434864454 2479.44238388619
7000 950.2029625625181 2293.992879225525
7000 454.75554061959514 2286.21048861993
7000 1.2724080243141e-13 2078.0
7000 -372.817605372821 1874.2806708505734
7000 -751.2075777326711 1813.5755223196559
7000 -942.2471152012455 1410.1724624651165
7000 -662.5590539717949 662.559053971795
7000 -466.4544525017279 311.6749007239968
7000 -371.39957206953727 153.83873981076613
7000 -344.2556334215339 68.47670302766099
7000 -341.0 4.176045585092474e-14
7000 -390.3525416004857 -77.64594816241909
7000 -371.3995720695373 -153.83873981076604
7000 -320.1158007364799 -213.89453971254687
7000 -306.17723625377516 -306.17723625377505
7000 -336.1199909768593 -503.03911544303986
7000 -260.60741744062597 -629.1619616401863
7000 -124.07744480225783 -623.7794383364545
7000 -1.0893233278415707e-13 -593.0
7000 113.54256741338668 -570.8170331946801
7000 226.93127539249838 -547.860562779193
7000 338.89784214195714 -507.19646350455275
7000 482.9539315504118 -482.95393155041205
7000 675.9847948019693 -451.6785994449366
7000 847.1975313128501 -350.9207074787871
7000 1242.6549502708929 -247.1794379944351
"""

data_pt2 = """
# Set 0
0 2459.0 0.0
0 2379.385090258237 473.2891212111271
0 2274.5914090427877 942.1666104828511
0 2111.932815248465 1411.1483918697895
0 2593.6676733922563 2593.6676733922563
0 1597.2644199313565 2390.4751353698175
0 996.507657878694 2405.7823026593906
0 447.5371987049984 2249.9214332450106
0 1.340375921666778e-13 2189.0
0 -406.373140759595 2042.975739079929
0 -797.894956481212 1926.2888252860328
0 -690.5737996433656 1033.5167280920637
0 -625.7895013500945 625.7895013500946
0 -630.2539661253294 421.12223662885845
0 -553.4038399742608 229.22737598668886
0 -514.912272211696 102.42241905846728
0 -499.0 6.110987527745293e-14
0 -469.7961493131474 -93.44826424572548
0 -444.38605513792896 -184.07073096760814
0 -418.2292149881803 -279.4518272088599
0 -401.6366517139591 -401.63665171395894
0 -351.67595750140816 -526.3202645875111
0 -256.39789968460997 -618.9992867825622
0 -124.46762544629009 -625.7410088972609
0 -1.0654427152581972e-13 -580.0
0 110.03094161709636 -553.162898147422
0 217.7468730157362 -525.6874539989221
0 335.5644207438395 -502.2076458307375
0 453.2554467405769 -453.25544674057704
0 631.9169053499344 -422.23337709489766
0 852.7408085079178 -353.21680807297764
0 1102.4026551732309 -219.2815219461287
# Set 1
500 2442.0 0.0
500 2355.8462435285596 468.60695348274004
500 2245.027264002427 929.9207406471681
500 2184.2706715187865 1459.483002142495
500 2444.468142561895 2444.468142561895
500 1706.1561856031985 2553.4431793811164
500 969.3371341807725 2340.186855851089
500 463.33951478830477 2329.365040957672
500 1.3281294536753046e-13 2169.0
500 -411.2503988099982 2067.49537109001
500 -811.2888766139902 1958.6246089239278
500 -976.6924696484608 1461.7235784278744
500 -703.5712472806147 703.5712472806148
500 -577.0399109379665 385.5657417156039
500 -520.1441768038544 215.45077242154562
500 -513.9314869312927 102.22732873645116
500 -482.0 5.902797571890243e-14
500 -462.93065235032475 -92.08263199161259
500 -439.76665747537254 -182.15731380578268
500 -414.90333653897005 -277.22954627678155
500 -381.83766184073573 -381.8376618407356
500 -362.23179192878064 -542.1181872212595
500 -260.60741744062597 -629.1619616401863
500 -119.59036739588687 -601.2213768871802
500 -1.0452360430722659e-13 -569.0
500 109.25058032903185 -549.239757025809
500 216.59882271864095 -522.9158154013883
500 323.3418756174083 -483.9153143600815
500 459.6194077712558 -459.619407771256
500 643.55747992217 -430.01136035717207
500 804.6990728173308 -333.31726958999303
500 1173.0191953622634 -233.32802513128996
# Set 2
1000 2452.0 0.0
1000 2377.4235196974305 472.8989405670949
1000 2276.4391681078105 942.9319773475812
1000 2200.068594152535 1470.0388365698673
1000 2486.187442651901 2486.187442651901
1000 1628.3763529804544 2437.03743365876
1000 1007.6054774172816 2432.574809102218
1000 469.5824050928209 2360.750169930576
1000 1.2975132836966208e-13 2119.0
1000 -382.7672117956435 1924.3007201511382
1000 -773.4032168098463 1867.1605352053105
1000 -952.2473793955983 1425.1389154865624
1000 -692.9646455628165 692.9646455628166
1000 -593.6693031840174 396.67714637599596
1000 -540.4695265191027 223.8698079335776
1000 -529.6240514177445 105.3487738887092
1000 -492.0 6.025262251804978e-14
1000 -474.7000757151635 -94.42371585580612
1000 -445.30993467044027 -184.4534143999732
1000 -425.71244149890316 -284.4519593060364
1000 -387.4945160902281 -387.494516090228
1000 -368.34306449199624 -551.2643529565875
1000 -263.28620146718157 -635.6291183677654
1000 -119.98054803991913 -603.1829474479866
1000 -1.0415621026748238e-13 -567.0
1000 108.66530936298346 -546.2974011845994
1000 215.45077242154568 -520.1441768038544
1000 322.23073515136906 -482.25237513547637
1000 456.7909806465096 -456.7909806465098
1000 638.5686622483547 -426.6779389590545
1000 811.1662295449098 -335.99605361654864
1000 1138.6917105481505 -226.49986386072544
# Set 3
1500 2476.0 0.0
1500 2391.1545136230757 475.63020507532065
1500 2266.2764932501864 938.7224595915652
1500 2190.090958804904 1463.371993773632
1500 2457.196064623253 2457.196064623253
1500 1634.48762554367 2446.183599394088
1500 1049.7006549774414 2534.2015576784597
1500 428.02816650338553 2151.8429052046877
1500 1.1885197185725063e-13 1941.0
1500 -385.6935666258854 1939.0124993571865
1500 -776.8473677011322 1875.475450997912
1500 -782.2428880916 1170.7092141219835
1500 -684.479364188578 684.4793641885781
1500 -586.1860766732945 391.6770142788195
1500 -539.5456469865915 223.4871245012125
1500 -527.6624808569379 104.95859324467695
1500 -489.0 5.988522847830558e-14
1500 -471.7577198739538 -93.83844488975774
1500 -442.5382960729064 -183.30536410287795
1500 -421.55509343739044 -281.67410814093836
1500 -386.7874093090416 -386.78740930904144
1500 -366.1207835599178 -547.9384745073774
1500 -271.32255354684844 -655.0305885505023
1500 -126.02834802241912 -633.5872911404867
1500 -1.1003451490338968e-13 -599.0
1500 114.71310934548345 -576.7017448770995
1500 228.07932568959365 -550.6322013767268
1500 342.23126354007474 -512.185281178368
1500 482.9539315504118 -482.95393155041205
1500 678.4792036388769 -453.3453101439954
1500 873.0661582231661 -361.63584358500964
1500 1193.6156862507312 -237.42492189362866
# Set 4
2000 2460.0 0.0
2000 2377.4235196974305 472.8989405670949
2000 2258.885456990096 935.6609921326445
2000 2171.798627334248 1451.1494486472009
2000 2450.1249968113875 2450.1249968113875
2000 1628.3763529804544 2437.03743365876
2000 1048.1699212479812 2530.5060395484143
2000 433.1005148758049 2177.3433224951714
2000 1.2093387141580112e-13 1975.0
2000 -396.61862465878863 1993.9364750597674
2000 -804.0178913990535 1941.0708978062135
2000 -810.5769699755997 1213.1141643494134
2000 -693.671752344003 693.6717523440032
2000 -591.1748943471098 395.01043567693716
2000 -539.5456469865915 223.4871245012125
2000 -528.6432661373412 105.15368356669308
2000 -493.0 6.037508719796452e-14
2000 -473.7192904347603 -94.22862553379
2000 -446.2338142029515 -184.8360978323383
2000 -426.5439111112057 -285.00752953905595
2000 -386.7874093090416 -386.78740930904144
2000 -368.34306449199624 -551.2643529565875
2000 -267.49571922319757 -645.7917932253895
2000 -123.49217383620945 -620.8370824952448
2000 -1.0746275662518023e-13 -585.0
2000 111.98184483725764 -562.9707509514543
2000 221.9563907717522 -535.8501288565462
2000 331.1198588796827 -495.5558889323171
2000 472.34732983261364 -472.34732983261387
2000 661.0183417805234 -441.67833525058376
2000 851.8169289754064 -352.8341246406126
2000 1154.384275034602 -229.62130901298352
# Set 5
2500 2452.0 0.0
2500 2365.654096332592 470.55785670290135
2500 2254.2660593275396 933.7475749708191
2500 2195.0797764787194 1466.7054151717498
2500 2439.5183950935893 2439.5183950935893
2500 1603.3756924945721 2399.6213011051454
2500 1038.2201520064887 2506.485171703121
2500 430.3692503675791 2163.612328569526
2500 1.2142373013546006e-13 1983.0
2500 -370.47652150862746 1862.5112474857347
2500 -750.0595274355759 1810.803883722122
2500 -987.2483040758333 1477.5215010616228
2500 -702.1570337182417 702.1570337182418
2500 -582.8601982240843 389.45473334674114
2500 -530.3068516614786 219.6602901775616
2500 -517.8546280529057 103.00769002451567
2500 -483.0 5.915044039881716e-14
2500 -465.87300819153444 -92.66790295766097
2500 -437.91889841035 -181.3919469410525
2500 -414.90333653897005 -277.22954627678155
2500 -379.71634149717613 -379.71634149717596
2500 -362.23179192878064 -542.1181872212595
2500 -274.76670443813424 -663.3455043431039
2500 -130.51542542879008 -656.145352589761
2500 -1.1389215232070384e-13 -620.0
2500 118.81000610782213 -597.2982357655674
2500 235.73299433689544 -569.1097920269526
2500 352.2315277344276 -527.1517341998139
2500 499.21738751770243 -499.21738751770266
2500 701.7603527833481 -468.90127666854426
2500 897.0870260684595 -371.585612826502
2500 1225.0008152236346 -243.66781219814476
# Set 6
3000 2427.0 0.0
3000 2363.6925257717853 470.16767605886906
3000 2245.951143534938 930.3034240795332
3000 2770.456748192081 1851.1600164213144
3000 2046.3670247538687 2046.3670247538687
3000 1394.4812848792017 2086.9887268793887
3000 796.746906184117 1923.517186688499
3000 380.2310376094341 1911.550511505896
3000 1.092384944839439e-13 1784.0
3000 -337.50625708790176 1696.7585350975887
3000 -665.4864888828911 1606.6265070371276
3000 -838.9110518595994 1255.519114576843
3000 -685.1864709697645 685.1864709697646
3000 -564.5678667534282 377.23218822030987
3000 -507.20986334869644 210.09320436843436
3000 -508.04677524887336 101.05678680435439
3000 -476.0 5.829318763941402e-14
3000 -459.98829650911506 -91.4973610255642
3000 -436.9950188778387 -181.0092635086874
3000 -409.9145188651548 -273.89612487866395
3000 -366.2813126546317 -366.28131265463156
3000 -235.0062085672917 -351.7116460039766
3000 -145.03702086636892 -350.1503428217777
3000 -66.52579980749988 -334.44778061750156
3000 -5.859934933920084e-14 -319.0
3000 59.50254821491913 -299.1395105229853
3000 120.54528119500335 -291.0220527410553
3000 181.6714661974098 -271.89056322293237
3000 255.2655480083436 -255.2655480083437
3000 374.9927951484479 -250.56217509184057
3000 509.05762241371906 -210.85857123316435
3000 2155.7660463263 -428.8085277914509
# Set 7
3500 2432.0 0.0
3500 2368.5964521738015 471.1431276689497
3500 2254.2660593275396 933.7475749708191
3500 2779.6029139274087 1857.27128898453
3500 2090.2076451874345 2090.2076451874345
3500 1395.0368551122212 2087.820196491691
3500 794.8334890222916 1918.8977890259425
3500 382.3770311516115 1922.3391495903315
3500 1.0948342384377337e-13 1788.0
3500 -339.2620699860469 1705.5856026212177
3500 -664.3384385857958 1603.8548684395937
3500 -815.5771020727761 1220.5973908601363
3500 -687.3077913133242 687.3077913133243
3500 -583.6916678363868 390.0103035797607
3500 -532.1546107265011 220.4256570422918
3500 -521.7777691745185 103.78805131258018
3500 -487.0 5.96402991184761e-14
3500 -468.8153640327441 -93.25317392370935
3500 -439.76665747537254 -182.15731380578268
3500 -416.56627576357516 -278.34068674282076
3500 -370.523953341751 -370.5239533417509
3500 -235.0062085672917 -351.7116460039766
3500 -145.03702086636892 -350.1503428217777
3500 -66.33070948548375 -333.4669953370983
3500 -5.804825827958454e-14 -316.0
3500 59.112367570886875 -297.1779399621788
3500 119.77991433027317 -289.17429367603273
3500 179.4491852653314 -268.5646847737222
3500 252.4371208835974 -252.43712088359752
3500 370.0039774746326 -247.22875369372298
3500 504.43822475116264 -208.9451540713389
3500 2149.881334643881 -427.63798585935416
# Set 8
4000 2428.0 0.0
4000 2364.6733110521886 470.3627663808852
4000 2252.4183002625173 932.9822081060889
4000 2788.7490796627367 1863.3825615477458
4000 2063.3375875023457 2063.3375875023457
4000 1386.1477313839077 2074.5166826948503
4000 789.8586044015454 1906.887355103296
4000 377.69486342322443 1898.800302860654
4000 1.0862617108437023e-13 1774.0
4000 -336.9209861218534 1693.816179256379
4000 -661.6596545592402 1597.3877117120148
4000 -835.5776304614818 1250.5302969030279
4000 -684.479364188578 684.4793641885781
4000 -564.5678667534282 377.23218822030987
4000 -510.90538147874156 211.62393809789472
4000 -504.12363412726046 100.27642551628988
4000 -475.0 5.817072295949927e-14
4000 -460.9690817895183 -91.69245134758033
4000 -436.07113934532737 -180.6265800763223
4000 -413.240397314365 -276.11840581074233
4000 -370.523953341751 -370.5239533417509
4000 -240.00634066446815 -359.19487251469957
4000 -147.71580489292455 -356.61749954935675
4000 -67.11107077354826 -337.39013645871125
4000 -5.896674337894505e-14 -321.0
4000 59.892728858951386 -301.10108108379177
4000 122.0760149244637 -294.7175708711004
4000 182.782606663449 -273.5535024475375
4000 257.3868683519032 -257.38686835190333
4000 370.0039774746326 -247.22875369372298
4000 505.3621042836739 -209.327837503704
4000 2207.7476661876713 -439.14831485830575
# Set 9
4500 2432.0 0.0
4500 2364.6733110521886 470.3627663808852
4500 2247.7989025999605 931.0687909442635
4500 2512.7011683782916 1678.9332441852378
4500 2040.0030637231898 2040.0030637231898
4500 1443.3714653849268 2160.1580527620126
4500 815.4983943700064 1968.787283781552
4500 388.2297408120954 1951.7627080024286
4500 1.1107546468266493e-13 1814.0
4500 -343.3589667483856 1726.1820935096855
4500 -675.0535746920183 1629.7234953499099
4500 -831.1330685973251 1243.8785400046074
4500 -697.9143930311224 697.9143930311225
4500 -587.8490158978996 392.78815474485873
4500 -536.7740083890576 222.33907420411722
4500 -529.6240514177445 105.3487738887092
4500 -493.0 6.037508719796452e-14
4500 -473.7192904347603 -94.22862553379
4500 -446.2338142029515 -184.8360978323383
4500 -423.21803266199555 -282.7852486069776
4500 -369.1097397793779 -369.1097397793778
4500 -235.0062085672917 -351.7116460039766
4500 -143.12360370454348 -345.5309451592213
4500 -65.55034819741923 -329.5438542154854
4500 -5.492540894175879e-14 -299.0
4500 54.430199842499796 -273.6390932325013
4500 110.21282852114592 -266.07730536325056
4500 166.67106990588056 -249.44088369076363
4500 237.5878784786799 -237.58787847868
4500 432.36419839732355 -288.8965211701931
4500 628.238082107675 -260.2247340082609
4500 817.9749238562941 -162.70532856145135
"""

def parse_xyz_data(data_string):
    """Convert the XYZ formatted string into numpy arrays"""
    sets = []
    current_set = []
    
    for line in data_string.split('\n'):
        if line.startswith("# Set"):
            if current_set:
                sets.append(np.array(current_set))
                current_set = []
        elif line.strip() and not line.startswith("#"):
            parts = list(map(float, line.split()))
            if len(parts) == 3:  # Ensure we have X,Y,Z
                current_set.append(parts)
    
    if current_set:  # Add the last set
        sets.append(np.array(current_set))
    return sets

# Load and parse both datasets
sets_pt1 = parse_xyz_data(data_pt1)
sets_pt2 = parse_xyz_data(data_pt2)

# Adjust data_pt2 to continue from data_pt1
x_increment = 500  # Distance between scans in mm
initial_x_pt2 = 7500  # Starting X for data_pt2 (after 15 scans at 500mm spacing)

# Combine all points with continuous X coordinates
all_points = []
scan_point_counts = []

# Add data_pt1 (sets 0-14)
for i, scan in enumerate(sets_pt1):
    all_points.extend(scan)
    scan_point_counts.append(len(scan))

# Add data_pt2 (sets 15-29)
for i, scan in enumerate(sets_pt2):
    adjusted_scan = scan.copy()
    adjusted_scan[:, 0] = initial_x_pt2 + i * x_increment  # Update X coordinates
    all_points.extend(adjusted_scan)
    scan_point_counts.append(len(adjusted_scan))

# Convert to numpy array
points_array = np.array(all_points)

# Create 3D visualization
pcd = o3d.geometry.PointCloud()
pcd.points = o3d.utility.Vector3dVector(points_array)

# Create connections between points (shows scanning pattern)
lines = []
point_offset = 0

for scan_idx in range(len(scan_point_counts)):
    num_points = scan_point_counts[scan_idx]
    
    # Connect points within scan (ring)
    for i in range(num_points - 1):
        lines.append([point_offset + i, point_offset + i + 1])
    lines.append([point_offset + num_points - 1, point_offset])  # Close ring
    
    # Connect to next scan (if exists)
    if scan_idx < len(scan_point_counts) - 1:
        next_scan_offset = point_offset + num_points
        next_scan_points = scan_point_counts[scan_idx + 1]
        
        # Connect corresponding points (assumes 32 points/scan)
        for i in range(min(num_points, next_scan_points)):
            lines.append([point_offset + i, next_scan_offset + i])
    
    point_offset += num_points

# Create line set for visualization
line_set = o3d.geometry.LineSet(
    points=o3d.utility.Vector3dVector(points_array),
    lines=o3d.utility.Vector2iVector(lines)
)

# Visualize
print("\nIntegrated 3D Scan Statistics:")
print(f"Total scans: {len(scan_point_counts)}")
print(f"Total points: {len(points_array)}")
print(f"X range: {points_array[:, 0].min():.1f} to {points_array[:, 0].max():.1f} mm")
print(f"Y range: {points_array[:, 1].min():.1f} to {points_array[:, 1].max():.1f} mm")
print(f"Z range: {points_array[:, 2].min():.1f} to {points_array[:, 2].max():.1f} mm")

vis = o3d.visualization.Visualizer()
vis.create_window(width=1280, height=720)
vis.add_geometry(pcd)
vis.add_geometry(line_set)

# Set camera to look down the hallway
ctr = vis.get_view_control()
ctr.set_front([0, -1, 0])  # Looking along the scanning (X) axis
ctr.set_up([0, 0, 1])      # Z-axis is up
ctr.set_zoom(0.8)

print("\nVisualizing integrated hallway scan...")
print("Press 'Q' to quit the visualization")
vis.run()

# Optional: Save the integrated point cloud
# o3d.io.write_point_cloud("integrated_hallway.pcd", pcd)